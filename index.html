<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Revision - Premium</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
</head>

<body>
    <div class="app-wrapper">
        <!-- Persistent Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-brand">
                <div class="brand-icon">F</div>
                <span>COMPUTER SCIENCE </span>
            </div>

            <nav class="sidebar-nav">
                <!-- Accordion Menu -->
                <div class="accordion-item active">
                    <button class="accordion-header" onclick="toggleAccordion(this)">
                        <span class="folder-icon">üìÇ</span> LECTURE 1: EXCEL
                        <span class="chevron">‚ñº</span>
                    </button>
                    <div class="accordion-content show">
                        <a href="#" class="nav-link active">Ex 1: NPV & IRR</a>
                        <a href="#" class="nav-link disabled" tabindex="-1">Ex 2: √† suivre </a>
                        <a href="#" class="nav-link disabled" tabindex="-1">Ex 3: √† suivre</a>
                    </div>
                </div>

                <!-- Main Content Area -->
                <main class="main-content">
                    <header class="page-header">
                        <h1>EXERCISE 1: NPV & IRR</h1>
                    </header>

                    <div class="cards-container">

                        <!-- NPV SECTION -->
                        <section class="content-card">
                            <h2 class="section-title">1. Net Present Value (NPV)</h2>

                            <div class="methods-grid">
                                <div class="method-column">
                                    <h3 class="method-title">Method 1 &ndash; Direct NPV Formula (Shortcut)</h3>
                                    <div class="code-block dark-mode">
                                        <div class="code-comment">// Case 1: If cash flows start at t = 1</div>
                                        <code><span class="excel-func">=NPV</span>(<span class="param">discount_rate</span>; <span class="param">range_of_CF</span>)</code>

                                        <div class="code-comment mt-4">// Case 2: If there is a cash flow at t = 0</div>
                                        <code>initial_CF + <span class="excel-func">NPV</span>(<span class="param">discount_rate</span>; <span class="param">range_of_CF</span>)</code>
                                    </div>
                                </div>

                                <div class="method-column">
                                    <h3 class="method-title">Method 2 &ndash; Manual Method (Discount each CF)</h3>
                                    <div class="code-block dark-mode">
                                        <div class="code-comment">// Formula for each period</div>
                                        <code>=CF / (1+<span class="param">rate</span>)^<span class="param">period</span></code>

                                        <div class="code-comment mt-4">// Final Step (t=1)</div>
                                        <code><span class="excel-func">=SUM</span>(<span class="param">range_of_DISCOUNTED_CFs</span>)</code>

                                        <div class="code-comment mt-4">// Final Step (t=0)</div>
                                        <code>initial_CF + <span class="excel-func">SUM</span>(<span class="param">range_of_DISCOUNTED_CFs</span>)</code>
                                    </div>
                                </div>
                            </div>

                            <button class="btn-note" onclick="toggleNote('note-npv')">
                                <span class="note-icon">üìù</span> NOTE
                            </button>

                            <div id="note-npv" class="post-it-note">
                                <p>The <span class="fluo">Net Present Value (NPV)</span> strictly measures the absolute
                                    <span class="fluo">value created</span> by taking on an investment.</p>
                                <p class="mt-2"><strong>Golden Rule:</strong> Always <span class="fluo accept">Accept if
                                        NPV >
                                        0</span> and <span class="fluo err">Reject if NPV < 0</span>. It is the most
                                            reliable
                                            metric in corporate finance because it assumes reinvestment at the cost of
                                            capital.
                                </p>
                            </div>
                        </section>

                        <!-- IRR SECTION -->
                        <section class="content-card">
                            <h2 class="section-title">2. Internal Rate of Return (IRR)</h2>

                            <div class="code-block dark-mode">
                                <code><span class="excel-func">=IRR</span>(<span class="param">range_including_t0</span>)</code>
                            </div>

                            <div class="alert-box">
                                <span class="alert-icon">‚ö†Ô∏è</span>
                                <strong>ATTENTION:</strong> <span class="fluo">include initial investment!</span> The
                                range must
                                start from t=0.
                            </div>

                            <button class="btn-note mt-4" onclick="toggleNote('note-irr')">
                                <span class="note-icon">üìù</span> NOTE
                            </button>

                            <div id="note-irr" class="post-it-note">
                                <p>The <span class="fluo">IRR</span> is the specific discount rate that forces the <span
                                        class="fluo">NPV to exactly zero</span>.</p>
                                <ul class="mt-2">
                                    <li>It represents the expected <span class="fluo">percentage annual yield</span> of
                                        the
                                        project.</li>
                                    <li><strong>Mathematical Check:</strong> <code>NPV(IRR, range) = 0</code></li>
                                    <li><strong>Pitfall:</strong> Struggles with non-conventional cash flows (multiple
                                        sign
                                        changes).</li>
                                </ul>
                            </div>
                        </section>

                        <!-- LOAN TABLE SECTION -->
                        <section class="content-card">
                            <h2 class="section-title">3. Loan Table (Amortization)</h2>

                            <div class="table-wrapper">
                                <table class="premium-table">
                                    <thead>
                                        <tr>
                                            <th>Year</th>
                                            <th>Principal (Beg)</th>
                                            <th>Payment (CF)</th>
                                            <th>Interest</th>
                                            <th>Principal Repaid</th>
                                            <th>Ending Principal</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="year-col">0</td>
                                            <td>-</td>
                                            <td class="formula-cell"><code>-Initial Inv.</code></td>
                                            <td>-</td>
                                            <td>-</td>
                                            <td>-</td>
                                        </tr>
                                        <tr>
                                            <td class="year-col">1</td>
                                            <td class="formula-cell"><code>=End. Princ (n-1)</code></td>
                                            <td class="formula-cell"><code>=CF 1</code></td>
                                            <td class="formula-cell"><code>=Beg. Princ * IRR</code></td>
                                            <td class="formula-cell"><code>=Pmt - Interest</code></td>
                                            <td class="formula-cell"><code>=Beg. Princ - Repaid</code></td>
                                        </tr>
                                        <tr>
                                            <td class="year-col">2</td>
                                            <td class="formula-cell"><code>=End. Princ 1</code></td>
                                            <td class="formula-cell"><code>=CF 2</code></td>
                                            <td class="formula-cell"><code>=Beg. Princ * IRR</code></td>
                                            <td class="formula-cell"><code>=Pmt - Interest</code></td>
                                            <td class="formula-cell"><code>=Beg. Princ - Repaid</code></td>
                                        </tr>
                                        <tr class="total-row">
                                            <td class="year-col">n</td>
                                            <td>...</td>
                                            <td>...</td>
                                            <td>...</td>
                                            <td>...</td>
                                            <td class="formula-cell"><code>0</code> <span class="total-note">(Fully
                                                    Amortized)</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <button class="btn-note mt-4" onclick="toggleNote('note-loan')">
                                <span class="note-icon">üìù</span> NOTE
                            </button>

                            <div id="note-loan" class="post-it-note">
                                <p>This table deconstructs how a flat <span class="fluo">Cash Flow</span> is split into
                                    <span class="fluo">Interest</span> and <span class="fluo">Principal Repayment</span>
                                    over
                                    time.</p>
                                <p class="mt-2">If you discount the cash flows at the IRR, the ending principal exactly
                                    hits
                                    <strong>0</strong> at year <em>n</em>, proving that the IRR fully covers the return
                                    of and
                                    return on the invested capital.
                                </p>
                            </div>
                        </section>

                    </div>
                </main>
    </div>

    <!-- Overlay Note System -->
    <div id="note-overlay" class="overlay" onclick="closeNote()"></div>

    <script src="script.js"></script>
</body>

</html>