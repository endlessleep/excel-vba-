<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Modelling Using MS Excel and VBA</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
</head>

<body>
    <div class="app-wrapper">

        <!-- ================= SIDEBAR ================= -->
        <aside class="sidebar">
            <div class="sidebar-brand">
                <span>EXCEL VBA CORE</span>
            </div>

            <nav class="sidebar-nav">
                <!-- Accordion Menu -->
                <div class="accordion-item active">
                    <button class="accordion-header" onclick="toggleAccordion(this)">
                        <span class="folder-icon">üìÇ</span> LECTURE 1: EXCEL
                        <span class="chevron">‚ñº</span>
                    </button>
                    <div class="accordion-content show">
                        <a href="index.html" class="nav-link active">Ex 1: NPV & IRR</a>
                        <a href="ex2.html" class="nav-link">Ex 2: Multiple IRRs</a>
                        <a href="ex3.html" class="nav-link">Ex 3: Advanced Data Tables</a>
                        <a href="ex4.html" class="nav-link">Ex 4: Payment Schedule</a>
                        <a href="ex5.html" class="nav-link">Ex 5: Future Value</a>
                        <a href="ex6.html" class="nav-link">Ex 6 & Case Study</a>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header" onclick="toggleAccordion(this)">
                        <span class="folder-icon">üìÅ</span> LECTURE 2: EXCEL
                        <span class="chevron">‚ñº</span>
                    </button>
                    <div class="accordion-content">
                        <a href="lecture2-ex1.html" class="nav-link">Ex 1: Gordon Model</a>
                        <a href="lecture2-ex2.html" class="nav-link">Ex 2: Two-Stage Model</a>
                        <a href="lecture2-ex3.html" class="nav-link">Ex 3: Cost of Capital</a>
                    </div>
                </div>
            </nav>
        </aside>
        <!-- ================= END SIDEBAR ================= -->

        <!-- ================= MAIN CONTENT ================= -->
        <main class="main-content">
            <header class="page-header">
                <h1>EXERCISE 1: NPV & IRR</h1>
            </header>

            <div class="cards-container">

                <!-- NPV SECTION -->
                <section class="content-card">
                    <h2 class="section-title">1. Net Present Value (NPV)</h2>

                    <div class="methods-grid">

                        <!-- METHOD 1 -->
                        <div class="method-column">
                            <h3 class="method-title">Method 1 &ndash; Direct NPV method </h3>
                            <div class="code-block dark-mode">
                                <div class="code-comment"> Case t=1</div>
                                <code><span class="excel-func">=NPV</span>(<span class="param">discount_rate</span>; <span class="param">range_of_CF</span>)</code>

                                <div class="code-comment mt-4"> Case t=0</div>
                                <code>initial_CF + <span class="excel-func">NPV</span>(<span class="param">discount_rate</span>; <span class="param">range_of_CF</span>)</code>
                            </div>
                        </div>

                        <!-- METHOD 2 -->
                        <div class="method-column">
                            <h3 class="method-title">Method 2 &ndash; Manual Method</h3>
                            <div class="code-block dark-mode">
                                <div class="code-comment"> Step 1 (Discounting)</div>
                                <code>=CF / (1+<span class="param">rate</span>)^<span class="param">period</span></code>

                                <div class="code-comment mt-4"> Step 2 - case t=1 </div>
                                <code><span class="excel-func">=SUM</span>(<span class="param">range_of_DISCOUNTED_CFs</span>)</code>

                                <div class="code-comment mt-4"> Step 2 - case t=0 </div>
                                <code>initial_CF + <span class="excel-func">SUM</span>(<span class="param">range_of_DISCOUNTED_CFs</span>)</code>
                            </div>
                        </div>

                    </div>

                    <div class="alert-box alert-red"
                        style="padding: 0.75rem 1rem; font-size: 0.9rem; margin-top: 1.5rem;">
                        <span class="alert-icon" style="font-size: 1rem;">üö®</span>
                        <span><strong>ATTENTION :</strong> N'oubliez pas d'utiliser les <strong><span class="fluo err"
                                    style="padding: 0 0.3em; margin: 0 0.2em;">$$</span></strong> (ex:
                            <code>$A$1</code>) si vous √©tirez la formule pour bloquer la cellule du <em>discount
                                rate</em> !</span>
                    </div>

                    <button class="btn-note" onclick="toggleNote('note-npv')">
                        <span class="note-icon">üìù</span> NOTE
                    </button>

                    <div id="note-npv" class="post-it-note">
                        <p><span class="fluo">Net Present Value (NPV)</span> equals the present value of all cash flows
                            discounted at rate r. It measures the net value added today by an investment.</p>
                        <p class="mt-2"><strong> Rule:</strong> Always <span class="fluo accept">Accept if NPV >
                                0</span> and <span class="fluo err">Reject if NPV < 0</span>.
                        </p>
                    </div>
                </section>

                <div id="note-npv" class="post-it-note">
                    <p><span class="fluo">Net Present Value (NPV)</span> equals the present value of all cash flows
                        discounted at rate r. It measures the net value added today by an investment.</p>
                    <p class="mt-2"><strong>Rule:</strong>
                        <span class="fluo accept">Accept if NPV &gt; 0</span> and
                        <span class="fluo err">Reject if NPV &lt; 0</span>.
                    </p>
                </div>

                <!-- IRR SECTION -->
                <section class="content-card">
                    <h2 class="section-title">2. Internal Rate of Return (IRR)</h2>

                    <div class="code-block dark-mode">
                        <code><span class="excel-func">=IRR</span>(<span class="param">range_of_CF</span>)</code>
                    </div>

                    <div class="alert-box">
                        <span class="alert-icon">‚ö†Ô∏è</span>
                        <strong>ATTENTION:</strong> <span class="fluo">include initial investment!</span> The range must
                        start from t=0.
                    </div>

                    <button class="btn-note mt-4" onclick="toggleNote('note-irr')">
                        <span class="note-icon">üìù</span> NOTE
                    </button>

                    <div id="note-irr" class="post-it-note">
                        <p>The <span class="fluo">IRR</span> is the specific discount rate that forces the <span
                                class="fluo">NPV to exactly zero</span>.</p>
                        <ul class="mt-2">
                            <li>It represents the expected <span class="fluo">percentage annual yield</span> of the
                                project.</li>
                            <li><strong>Mathematical Check:</strong> <code>NPV(IRR, range) = 0</code></li>
                        </ul>
                    </div>
                </section>

                <!-- LOAN TABLE SECTION -->
                <section class="content-card">
                    <h2 class="section-title">3. Loan Table (Amortization)</h2>

                    <div class="table-wrapper">
                        <table class="premium-table">
                            <thead>
                                <tr>
                                    <th>Year</th>
                                    <th>Beginning Principal </th>
                                    <th>Annual Payment </th>
                                    <th>Interest</th>
                                    <th>Principal Repaid</th>
                                    <th>Ending Principal</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="year-col">t=1</td>
                                    <td class="formula-cell"><code> Initial investment = Ending Principal (t-1) </code>
                                    </td>
                                    <td class="formula-cell"><code> Fixed Payment </code></td>
                                    <td class="formula-cell"><code>Beginning Principal * IRR</code></td>
                                    <td class="formula-cell"><code>Annual Payment - Interest</code></td>
                                    <td class="formula-cell"><code>Beginning Principal - Principal Repaid</code></td>
                                </tr>
                                <tr class="total-row">
                                    <td class="year-col">t=T</td>
                                    <td>...</td>
                                    <td>...</td>
                                    <td>...</td>
                                    <td>...</td>
                                    <td class="formula-cell"><code>0</code> <span class="total-note">(Fully
                                            Amortized)</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <button class="btn-note mt-4" onclick="toggleNote('note-loan')">
                        <span class="note-icon">üìù</span> NOTE
                    </button>

                    <div id="note-loan" class="post-it-note">
                        <p>how a <span class="fluo">Cash Flow</span> is split into <span class="fluo">Interest</span>
                            and <span class="fluo">Principal Repayment</span> over time.</p>
                        <p class="mt-2">If you discount the cash flows at the IRR, the ending principal exactly hits
                            <strong>0</strong> at year <em>t = T</em>, proving that the IRR fully covers the return of
                            and
                            return on the invested capital.
                        </p>
                    </div>
                </section>

            </div>
        </main>
        <!-- ================= END MAIN CONTENT ================= -->

    </div>

    <!-- Overlay Note System -->
    <div id="note-overlay" class="overlay" onclick="closeNote()"></div>

    <script src="script.js"></script>
</body>

</html>

</html>