<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Modelling Using MS Excel and VBA</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        .data-table-simple th {
            background-color: #F8F9FA;
            color: var(--clr-excel-green);
            font-weight: 700;
            border: 2px solid #EAEAEA;
            text-align: center;
        }

        .data-table-simple td {
            text-align: center;
            border: 1px solid #EAEAEA;
        }

        .data-table-simple .ref-cell {
            background-color: var(--clr-code-bg);
            color: var(--clr-excel-func);
            font-family: 'Consolas', monospace;
            font-weight: 700;
        }

        .matrix-table th,
        .matrix-table td {
            border: 1px solid #EAEAEA;
            text-align: center;
            padding: 1rem;
        }

        .matrix-top-row {
            background-color: var(--clr-excel-green);
            color: white;
            font-weight: 700;
        }

        .matrix-corner {
            background-color: var(--clr-code-bg);
            color: var(--clr-param);
            font-family: 'Consolas', monospace;
            font-weight: 700;
            border: 2px solid var(--clr-excel-green);
        }

        .matrix-side-col {
            background-color: #F8F9FA;
            color: var(--clr-excel-green);
            font-weight: 700;
        }

        .matrix-body-cell {
            background-color: white;
            color: #ccc;
            font-style: italic;
        }
    </style>
</head>

<body>
    <div class="app-wrapper">

        <!-- ================= SIDEBAR ================= -->
        <aside class="sidebar">
            <div class="sidebar-brand">
                <span>EXCEL VBA CORE</span>
            </div>

            <nav class="sidebar-nav">
                <!-- Accordion Menu -->
                <div class="accordion-item active">
                    <button class="accordion-header" onclick="toggleAccordion(this)">
                        <span class="folder-icon">üìÇ</span> LECTURE 1: EXCEL
                        <span class="chevron">‚ñº</span>
                    </button>
                    <div class="accordion-content show">
                        <a href="index.html" class="nav-link">Ex 1: NPV & IRR</a>
                        <a href="ex2.html" class="nav-link">Ex 2: Multiple IRRs</a>
                        <a href="ex3.html" class="nav-link active">Ex 3: Advanced Data Tables</a>
                        <a href="ex4.html" class="nav-link">Ex 4: Payment Schedule</a>
                        <a href="ex5.html" class="nav-link">Ex 5: Future Value</a>
                        <a href="ex6.html" class="nav-link">Ex 6 & Case Study</a>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header" onclick="toggleAccordion(this)">
                        <span class="folder-icon">üìÅ</span> LECTURE 2: EXCEL
                        <span class="chevron">‚ñº</span>
                    </button>
                    <div class="accordion-content">
                        <a href="lecture2-ex1.html" class="nav-link">Ex 1: Gordon Model</a>
                    </div>
                </div>
            </nav>
        </aside>
        <!-- ================= END SIDEBAR ================= -->

        <!-- ================= MAIN CONTENT ================= -->
        <main class="main-content">
            <header class="page-header">
                <h1>EX 3: ADVANCED DATA TABLES</h1>
            </header>

            <div class="cards-container">

                <!-- SECTION 1 -->
                <section class="content-card">
                    <h2 class="section-title">SECTION 1: 1 INPUT &rarr; 2 OUTPUTS </h2>
                    <p style="margin-bottom: 1.5rem; font-size: 1.05rem;"><strong>Objective:</strong> Vary 1 input
                        (Growth Rate) for 2 outputs (NPV and IRR). </p>

                    <div class="methods-grid" style="grid-template-columns: 1fr;">
                        <div class="method-column">
                            <h3 class="method-title">DATA TABLE</h3>
                            <div class="table-wrapper"
                                style="margin-top: 1rem; border: 2px solid var(--clr-excel-green);">
                                <table class="premium-table data-table-simple">
                                    <thead>
                                        <tr>
                                            <th>Growth Rate</th>
                                            <th class="ref-cell">=NPV_cell</th>
                                            <th class="ref-cell">=IRR_cell</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="font-weight: 700; color: var(--clr-excel-green);">2%</td>
                                            <td style="color:#888;"><em>result</em></td>
                                            <td style="color:#888;"><em>result</em></td>
                                        </tr>
                                        <tr>
                                            <td style="font-weight: 700; color: var(--clr-excel-green);">4%</td>
                                            <td style="color:#888;"><em>result</em></td>
                                            <td style="color:#888;"><em>result</em></td>
                                        </tr>
                                        <tr>
                                            <td style="font-weight: 700; color: var(--clr-excel-green);">6%</td>
                                            <td style="color:#888;"><em>result</em></td>
                                            <td style="color:#888;"><em>result</em></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="code-comment mt-4" style="font-size: 0.95rem;">
                                <strong>ATTENTION:</strong> The cells immediately above the empty results must contain
                                the
                                exact reference to the calculation.
                            </div>

                            <div class="code-block dark-mode" style="margin-top: 1rem;">
                                <div class="code-comment">// Action:</div>
                                <p style="color: #D4D4D4; margin-bottom: 0.5rem;">Select Table &rarr; Data &rarr;
                                    What-If Analysis &rarr; Data Table</p>
                                <code>Column input cell = <span class="param">Growth Rate Cell Reference</span></code>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- SECTION 2 -->
                <section class="content-card">
                    <h2 class="section-title">SECTION 2: 2 INPUTS &rarr; 1 OUTPUT (THE MATRIX) </h2>
                    <p style="margin-bottom: 1.5rem; font-size: 1.05rem;"><strong>Objective:</strong> Vary 2 inputs
                        (Discount
                        Rate AND Growth Rate) for a single output (NPV).</p>

                    <div class="methods-grid" style="grid-template-columns: 1fr;">
                        <div class="method-column">
                            <h3 class="method-title"> DATA TABLE</h3>
                            <div class="table-wrapper"
                                style="margin-top: 1rem; border: 1px solid #EAEAEA; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 15px rgba(33, 115, 70, 0.05);">
                                <table style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
                                    <tr>
                                        <td
                                            style="background-color: var(--clr-code-bg); color: var(--clr-param); font-family: 'Consolas', monospace; font-weight: 700; padding: 1.5rem 1rem; border-right: 2px solid white; border-bottom: 2px solid white; text-align: center;">
                                            =NPV Reference<br>
                                            <span style="font-size: 0.75rem; color: #888; font-weight: normal;">(DO NOT
                                                FORGET THE OUTPUT
                                                REFERENCE)</span>
                                        </td>
                                        <td colspan="3"
                                            style="background-color: var(--clr-excel-green); color: white; font-weight: 700; padding: 1rem; text-align: center; letter-spacing: 1px;">
                                            DISCOUNT RATES
                                        </td>
                                    </tr>
                                    <tr>
                                        <td rowspan="4"
                                            style="background-color: #F8F9FA; color: var(--clr-excel-green); font-weight: 700; border-right: 2px solid #EAEAEA; writing-mode: vertical-rl; transform: rotate(180deg); text-align: center; padding: 1rem; letter-spacing: 1px;">
                                            GROWTH RATES</td>
                                        <td
                                            style="font-weight: 700; background-color: #e8f5e9; padding: 0.85rem; text-align: center; border-bottom: 1px solid #d0e8d3; border-right: 1px solid #d0e8d3;">
                                            8%</td>
                                        <td
                                            style="font-weight: 700; background-color: #e8f5e9; padding: 0.85rem; text-align: center; border-bottom: 1px solid #d0e8d3; border-right: 1px solid #d0e8d3;">
                                            10%</td>
                                        <td
                                            style="font-weight: 700; background-color: #e8f5e9; padding: 0.85rem; text-align: center; border-bottom: 1px solid #d0e8d3;">
                                            12%</td>
                                    </tr>
                                    <tr>
                                        <td
                                            style="font-weight: 700; background-color: #f1f8e9; color: var(--clr-excel-green); padding: 0.85rem; text-align: center; border-bottom: 1px solid #EAEAEA; border-right: 1px solid #EAEAEA;">
                                            1%</td>
                                        <td
                                            style="background-color: white; color: #888; font-style: italic; text-align: center; border-bottom: 1px solid #EAEAEA; border-right: 1px solid #EAEAEA;">
                                            NPV</td>
                                        <td
                                            style="background-color: white; color: #888; font-style: italic; text-align: center; border-bottom: 1px solid #EAEAEA;">
                                            NPV</td>
                                    </tr>
                                    <tr>
                                        <td
                                            style="font-weight: 700; background-color: #f1f8e9; color: var(--clr-excel-green); padding: 0.85rem; text-align: center; border-bottom: 1px solid #EAEAEA; border-right: 1px solid #EAEAEA;">
                                            2%</td>
                                        <td
                                            style="background-color: white; color: #888; font-style: italic; text-align: center; border-bottom: 1px solid #EAEAEA; border-right: 1px solid #EAEAEA;">
                                            NPV</td>
                                        <td
                                            style="background-color: white; color: #888; font-style: italic; text-align: center; border-bottom: 1px solid #EAEAEA;">
                                            NPV</td>
                                    </tr>
                                    <tr>
                                        <td
                                            style="font-weight: 700; background-color: #f1f8e9; color: var(--clr-excel-green); padding: 0.85rem; text-align: center; border-right: 1px solid #EAEAEA;">
                                            3%</td>
                                        <td
                                            style="background-color: white; color: #888; font-style: italic; text-align: center; border-right: 1px solid #EAEAEA;">
                                            NPV</td>
                                        <td
                                            style="background-color: white; color: #888; font-style: italic; text-align: center;">
                                            NPV</td>
                                    </tr>
                                </table>
                            </div>

                            <div class="code-block dark-mode mt-4">
                                <div class="code-comment">// Step-by-Step Tutorial:</div>
                                <ul style="color: #D4D4D4; margin-left: 1.5rem; margin-bottom: 1rem; line-height: 1.8;">
                                    <li>Select the <strong>entire rectangle</strong> (including the top-left corner
                                        <code>=NPV Reference</code>).
                                    </li>
                                    <li>Go to: Data &rarr; What-If Analysis &rarr; Data Table.</li>
                                </ul>
                                <code>Row input cell = <span class="param">Discount Rate Reference</span></code><br>
                                <code
                                    style="display: inline-block; margin-top: 0.5rem;">Column input cell = <span class="param">Growth Rate Reference</span></code>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- IMPORTANT NOTE -->
                <section class="content-card" style="background-color: #E3F2FD; border-color: #64B5F6;">
                    <h3
                        style="color: #0D47A1; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; font-size: 1.1rem;">
                        <span>‚ö†Ô∏è</span> Important &mdash; Data Table &amp; Input Cell
                    </h3>
                    <ul
                        style="color: #1565C0; line-height: 1.6; padding-left: 1.5rem; margin-bottom: 0; font-size: 0.95rem;">
                        <li style="margin-bottom: 0.5rem;">In a Data Table: The input cell (e.g., discount rate or
                            growth rate) <strong>must remain a normal model cell</strong>.</li>
                        <li style="margin-bottom: 0.5rem;">It must <strong>not be a cell calculated by the Data
                                Table</strong> (i.e., it must not contain <code>=TABLE(...)</code>).</li>
                        <li style="margin-bottom: 0.5rem;">The input cell can be visually inside the selected area, but
                            it must not be part of the result cells generated by the Data Table.</li>
                        <li>Excel temporarily replaces the value of the input cell during computation, but it does not
                            transform it into a <code>=TABLE()</code> cell.</li>
                    </ul>
                </section>

            </div>
        </main>
        <!-- ================= END MAIN CONTENT ================= -->

    </div>

    <!-- Overlay Note System -->
    <div id="note-overlay" class="overlay" onclick="closeNote()"></div>

    <script src="script.js"></script>
</body>

</html>