<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Modelling Using MS Excel and VBA</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        .data-table-simple th {
            background-color: #F8F9FA;
            color: var(--clr-excel-green);
            font-weight: 700;
            border: 2px solid #EAEAEA;
            text-align: center;
        }

        .data-table-simple td {
            text-align: center;
            border: 1px solid #EAEAEA;
        }

        .data-table-simple .ref-cell {
            background-color: var(--clr-code-bg);
            color: var(--clr-excel-func);
            font-family: 'Consolas', monospace;
            font-weight: 700;
        }

        .matrix-table th,
        .matrix-table td {
            border: 1px solid #EAEAEA;
            text-align: center;
            padding: 1rem;
        }

        .matrix-top-row {
            background-color: var(--clr-excel-green);
            color: white;
            font-weight: 700;
        }

        .matrix-corner {
            background-color: var(--clr-code-bg);
            color: var(--clr-param);
            font-family: 'Consolas', monospace;
            font-weight: 700;
            border: 2px solid var(--clr-excel-green);
        }

        .matrix-side-col {
            background-color: #F8F9FA;
            color: var(--clr-excel-green);
            font-weight: 700;
        }

        .matrix-body-cell {
            background-color: white;
            color: #ccc;
            font-style: italic;
        }
    </style>
</head>

<body>
    <div class="app-wrapper">

        <!-- ================= SIDEBAR ================= -->
        <aside class="sidebar">
            <div class="sidebar-brand">
                <span>EXCEL VBA CORE</span>
            </div>

            <nav class="sidebar-nav">
                <!-- Accordion Menu -->
                <div class="accordion-item active">
                    <button class="accordion-header" onclick="toggleAccordion(this)">
                        <span class="folder-icon">üìÇ</span> LECTURE 1: EXCEL
                        <span class="chevron">‚ñº</span>
                    </button>
                    <div class="accordion-content show">
                        <a href="index.html" class="nav-link">Ex 1: NPV & IRR</a>
                        <a href="ex2.html" class="nav-link">Ex 2: Multiple IRRs</a>
                        <a href="ex3.html" class="nav-link active">Ex 3: Advanced Data Tables</a>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header" onclick="toggleAccordion(this)">
                        <span class="folder-icon">üìÅ</span> LECTURE 2: EXCEL
                        <span class="chevron">‚ñº</span>
                    </button>
                    <div class="accordion-content">
                        <a href="#" class="nav-link disabled" tabindex="-1">Ex 1: √† suivre </a>
                        <a href="#" class="nav-link disabled" tabindex="-1">Ex 2: √† suivre</a>
                    </div>
                </div>
            </nav>
        </aside>
        <!-- ================= END SIDEBAR ================= -->

        <!-- ================= MAIN CONTENT ================= -->
        <main class="main-content">
            <header class="page-header">
                <h1>EX 3: ADVANCED DATA TABLES</h1>
                <p style="margin-top: 0.5rem; font-size: 1.1rem; color: var(--clr-text-muted);">Master multi-variable
                    sensitivity analysis.</p>
            </header>

            <div class="cards-container">

                <!-- SECTION 1 -->
                <section class="content-card">
                    <h2 class="section-title">SECTION 1: 1 INPUT &rarr; 2 OUTPUTS (SIMPLE)</h2>
                    <p style="margin-bottom: 1.5rem; font-size: 1.05rem;"><strong>Objectif :</strong> Tester 1 variable
                        (ex: Growth Rate) pour voir l'impact sur 2 r√©sultats (NPV et IRR).</p>

                    <div class="methods-grid" style="grid-template-columns: 1fr;">
                        <div class="method-column">
                            <h3 class="method-title">Tuto Visuel</h3>
                            <div class="table-wrapper"
                                style="margin-top: 1rem; border: 2px solid var(--clr-excel-green);">
                                <table class="premium-table data-table-simple">
                                    <thead>
                                        <tr>
                                            <th>Growth Rate</th>
                                            <th class="ref-cell">=NPV_cell</th>
                                            <th class="ref-cell">=IRR_cell</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="font-weight: 700; color: var(--clr-excel-green);">2%</td>
                                            <td style="color:#aaa;"><em>result</em></td>
                                            <td style="color:#aaa;"><em>result</em></td>
                                        </tr>
                                        <tr>
                                            <td style="font-weight: 700; color: var(--clr-excel-green);">4%</td>
                                            <td style="color:#aaa;"><em>result</em></td>
                                            <td style="color:#aaa;"><em>result</em></td>
                                        </tr>
                                        <tr>
                                            <td style="font-weight: 700; color: var(--clr-excel-green);">6%</td>
                                            <td style="color:#aaa;"><em>result</em></td>
                                            <td style="color:#aaa;"><em>result</em></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="code-comment mt-4" style="font-size: 0.95rem;">
                                <strong>CRUCIAL :</strong> Les cellules juste au-dessus des futurs r√©sultats doivent
                                contenir la r√©f√©rence exacte vers le calcul.
                            </div>

                            <div class="code-block dark-mode" style="margin-top: 1rem;">
                                <div class="code-comment">// Action :</div>
                                <p style="color: #D4D4D4;">Select Table &rarr; Data Table</p>
                                <code>Column input cell = <span class="param">cellule du Growth Rate</span></code>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- SECTION 2 -->
                <section class="content-card">
                    <h2 class="section-title">SECTION 2: 2 INPUTS &rarr; 1 OUTPUT (THE MATRIX)</h2>
                    <p style="margin-bottom: 1.5rem; font-size: 1.05rem;"><strong>Objectif :</strong> Faire varier le
                        Discount Rate ET le Growth Rate en m√™me temps pour un seul output (NPV).</p>

                    <div class="methods-grid" style="grid-template-columns: 1fr;">
                        <div class="method-column">
                            <h3 class="method-title">LA MATRICE VISUELLE (D√âTAILS DE FOU)</h3>
                            <div class="table-wrapper"
                                style="margin-top: 1rem; box-shadow: 0 4px 20px rgba(33, 115, 70, 0.15);">
                                <table class="matrix-table" style="width: 100%; border-collapse: collapse;">
                                    <tr>
                                        <td class="matrix-corner">
                                            =NPV Reference<br>
                                            <span style="font-size: 0.75rem; color: #888; font-weight: normal;">(L'angle
                                                o√π tout se joue)</span>
                                        </td>
                                        <td colspan="3" class="matrix-top-row">DISCOUNT RATES</td>
                                    </tr>
                                    <tr>
                                        <td rowspan="4" class="matrix-side-col"
                                            style="writing-mode: vertical-rl; transform: rotate(180deg); text-align: center;">
                                            GROWTH RATES</td>
                                        <td style="font-weight: 700; background-color: #e8f5e9;">8%</td>
                                        <td style="font-weight: 700; background-color: #e8f5e9;">10%</td>
                                        <td style="font-weight: 700; background-color: #e8f5e9;">12%</td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: 700; background-color: #f1f8e9;">1%</td>
                                        <td class="matrix-body-cell">NPV</td>
                                        <td class="matrix-body-cell">NPV</td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: 700; background-color: #f1f8e9;">2%</td>
                                        <td class="matrix-body-cell">NPV</td>
                                        <td class="matrix-body-cell">NPV</td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: 700; background-color: #f1f8e9;">3%</td>
                                        <td class="matrix-body-cell">NPV</td>
                                        <td class="matrix-body-cell">NPV</td>
                                    </tr>
                                </table>
                            </div>

                            <div class="code-block dark-mode mt-4">
                                <div class="code-comment">// Tuto Pas-√†-Pas :</div>
                                <ul style="color: #D4D4D4; margin-left: 1.5rem; margin-bottom: 1rem; line-height: 1.8;">
                                    <li>S√©lectionne <strong>tout le rectangle</strong> (incluant l'angle
                                        <code>=NPV Reference</code>).</li>
                                    <li>Go to: Data &rarr; What-If Analysis &rarr; Data Table.</li>
                                </ul>
                                <code>Row input cell = <span class="param">cellule du Discount Rate</span></code><br>
                                <code
                                    style="display: inline-block; margin-top: 0.5rem;">Column input cell = <span class="param">cellule du Growth Rate</span></code>
                            </div>
                        </div>
                    </div>

                    <button class="btn-note" onclick="toggleNote('note-recalc')">
                        <span class="note-icon">üí°</span> ASTUCE PRO
                    </button>

                    <div id="note-recalc" class="post-it-note" style="background-color: #B2D3C2;">
                        <p style="font-weight: 600; color: #111;">Si les chiffres ne changent pas, appuie sur <span
                                class="fluo accept" style="background-color: #ffffff; color: #217346;">F9</span>.</p>
                        <p class="mt-2" style="color: #222;">Excel bloque parfois le calcul automatique des Data Tables
                            pour √©conomiser de la batterie et de la RAM ! Appuyer sur F9 force le recalcul de la
                            feuille.</p>
                    </div>
                </section>

            </div>
        </main>
        <!-- ================= END MAIN CONTENT ================= -->

    </div>

    <!-- Overlay Note System -->
    <div id="note-overlay" class="overlay" onclick="closeNote()"></div>

    <script src="script.js"></script>
</body>

</html>