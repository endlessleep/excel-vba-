<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Modelling Using MS Excel and VBA</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        .math-block {
            background-color: var(--clr-bg-card);
            border: 2px dashed var(--clr-excel-green);
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            font-family: 'Consolas', monospace;
            font-size: 1.1rem;
            color: var(--clr-text-main);
            margin: 1.5rem 0;
            box-shadow: 0 4px 15px rgba(33, 115, 70, 0.05);
        }

        .vs-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            box-shadow: 0 4px 15px rgba(33, 115, 70, 0.05);
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #EAEAEA;
        }

        .vs-table th,
        .vs-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #EAEAEA;
        }

        .vs-table th {
            background-color: #F8F9FA;
            color: var(--clr-excel-green);
            font-weight: 700;
        }

        .vs-table td {
            background-color: white;
            color: #444;
        }
    </style>
</head>

<body>
    <div class="app-wrapper">

        <!-- ================= SIDEBAR ================= -->
        <aside class="sidebar">
            <div class="sidebar-brand">
                <span>EXCEL VBA CORE</span>
            </div>

            <nav class="sidebar-nav">
                <!-- Accordion Menu -->
                <div class="accordion-item">
                    <button class="accordion-header" onclick="toggleAccordion(this)">
                        <span class="folder-icon">üìÇ</span> LECTURE 1: EXCEL
                        <span class="chevron">‚ñº</span>
                    </button>
                    <div class="accordion-content">
                        <a href="index.html" class="nav-link">Ex 1: NPV & IRR</a>
                        <a href="ex2.html" class="nav-link">Ex 2: Multiple IRRs</a>
                        <a href="ex3.html" class="nav-link">Ex 3: Advanced Data Tables</a>
                        <a href="ex4.html" class="nav-link">Ex 4: Payment Schedule</a>
                        <a href="ex5.html" class="nav-link">Ex 5: Future Value</a>
                        <a href="ex6.html" class="nav-link active">Ex 6 & Case Study</a>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header" onclick="toggleAccordion(this)">
                        <span class="folder-icon">üìÇ</span> LECTURE 2: EXCEL
                        <span class="chevron">‚ñº</span>
                    </button>
                    <div class="accordion-content show">
                        <a href="lecture2-ex1.html" class="nav-link active">Ex 1: Gordon Model</a>
                    </div>
                </div>
            </nav>
        </aside>
        <!-- ================= END SIDEBAR ================= -->

        <!-- ================= MAIN CONTENT ================= -->
        <main class="main-content">
            <header class="page-header">
                <h1>EX 1: SHARE VALUATION & GORDON MODEL</h1>
            </header>

            <div class="content-scroll">

                <!-- INTRODUCTION -->
                <div
                    style="background-color: #E8F5E9; border-left: 6px solid #2E7D32; padding: 1.5rem; border-radius: 8px; margin-bottom: 2.5rem; box-shadow: 0 4px 15px rgba(46, 125, 50, 0.1);">
                    <h3
                        style="color: #2E7D32; font-size: 1.25rem; margin-bottom: 1rem; border-bottom: 1px solid #C8E6D6; padding-bottom: 0.5rem;">
                        üè¢ What is a share (stock)?
                    </h3>
                    <p style="color: #444; font-size: 1.05rem; margin-bottom: 1rem; line-height: 1.6;">
                        A share (stock) represents ownership in a company.<br><br>
                        When you buy a share, you buy:
                    </p>
                    <ul
                        style="color: #444; font-size: 1.05rem; margin-left: 1.5rem; margin-bottom: 1.5rem; line-height: 1.6;">
                        <li><strong>The right to receive future dividends</strong></li>
                        <li><strong>A claim on future profits</strong></li>
                    </ul>
                    <p style="color: #444; font-size: 1.05rem; margin-bottom: 1rem; line-height: 1.6;">
                        So the value of a share comes from: <strong>The future cash flows it will generate.</strong>
                    </p>
                    <p
                        style="color: #444; font-size: 1.1rem; font-weight: 500; font-style: italic; background-color: #FFFFFF; padding: 0.8rem; border-radius: 4px; border-left: 3px solid #2E7D32; margin: 0; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
                        In dividend models, we assume:<br>
                        <span
                            style="color: #2E7D32; font-weight: bold; display: block; margin-top: 0.5rem; font-size: 1.2rem;">Share
                            value = Present value of all future dividends.</span>
                    </p>
                </div>

                <!-- SECTION 1: FINITE HORIZON -->
                <section class="content-card">
                    <h2 class="section-title">1Ô∏è‚É£ FINITE HORIZON (NPV METHOD)</h2>

                    <div class="method-column">
                        <p style="margin-bottom: 1rem; color: #444; font-size: 1.05rem;">
                            Use this when you have a list of dividends for a few years.
                        </p>

                        <strong style="color: #333; display: block; margin-top: 1rem;">The Mathematical Formula
                            :</strong>
                        <div class="math-block"
                            style="font-size: 1.1rem; padding: 1rem; border-color: rgba(33,115,70,0.3);">
                            <span style="font-size: 1.3rem;">Price = &sum; [ D<sub>t</sub> / (1+r)&#7491; ]</span>
                        </div>

                        <strong style="color: #333; display: block; margin-top: 1.5rem;">The Excel Implementation
                            :</strong>
                        <div class="code-block dark-mode" style="margin-bottom: 1.5rem;">
                            <code><span class="excel-func">=NPV</span>(<span class="param">r</span> ; <span class="param">range_of_dividends</span>)</code>
                        </div>

                        <div
                            style="background-color: #FFF3E0; border-left: 4px solid #FF9800; padding: 1rem; border-radius: 4px;">
                            <strong style="color: #E65100;">üö® ATTENTION</strong><br>
                            <span style="color: #555;">NPV starts at Year 1. Never put Year 0 inside!</span>
                        </div>
                    </div>
                </section>

                <!-- SECTION 2: INFINITE HORIZON -->
                <section class="content-card" style="border-top: 4px solid var(--clr-excel-green);">
                    <h2 class="section-title" style="color: var(--clr-excel-green);">2Ô∏è‚É£ INFINITE HORIZON (GORDON GROWTH
                        MODEL)</h2>

                    <div class="method-column">
                        <p style="margin-bottom: 1rem; color: #444; font-size: 1.05rem;">
                            Use this when dividends grow forever at a constant rate g.
                        </p>

                        <strong style="color: #333; display: block; margin-top: 1rem;">Simple Formula :</strong>
                        <div class="math-block"
                            style="font-size: 1.4rem; font-weight: bold; background-color: #E8F5E9; border-color: var(--clr-excel-green); color: var(--clr-excel-green);">
                            Price = D1 / (r - g)
                        </div>


                        <div
                            style="background-color: #FFF; border: 1px solid #EAEAEA; padding: 1.5rem; border-radius: 8px; margin-top: 1.5rem;">
                            <h4 style="color: #333; margin-bottom: 1rem; font-size: 1.15rem;">The Rules:</h4>
                            <ul style="color: #555; line-height: 1.7; margin: 0; padding-left: 1.5rem;">
                                <li><strong>r</strong> = Required return (Le rendement voulu par l'investisseur).</li>
                                <li><strong>g</strong> = Growth rate (La vitesse de croissance du dividende).</li>
                            </ul>
                        </div>
                        <div
                            style="background-color: #FFEBEE; border: 2px solid #D32F2F; padding: 1rem; border-radius: 6px; margin-top: 1.5rem; text-align: center;">
                            <strong style="color: #D32F2F; font-size: 1.2rem; display: block; margin-bottom: 0.5rem;">üö®
                                ABSOLUTE SURVIVAL CONDITION üö®</strong>
                            <span style="color: #B71C1C; font-size: 1.1rem; font-weight: bold;">Condition: r MUST be
                                greater than g (r > g)</span>
                        </div>

                        <!-- WHY (R - G) INTUITION -->
                        <div
                            style="background-color: #FAFAFA; border: 1px solid #E0E0E0; border-radius: 8px; padding: 1.5rem; margin-top: 2rem; border-left: 5px solid #0D47A1;">
                            <h4
                                style="color: #0D47A1; margin-bottom: 1rem; border-bottom: 1px solid #E3F2FD; padding-bottom: 0.5rem; font-size: 1.2rem;">
                                üß† WHY (r - g) ? (INTUITION)</h4>
                            <ul
                                style="color: #444; line-height: 1.8; margin: 0; padding-left: 1.5rem; font-size: 1.05rem;">
                                <li><strong style="color: #2E7D32;">g pushes the price UP</strong> (More growth = More
                                    value).</li>
                                <li><strong style="color: #D32F2F;">r pushes the price DOWN</strong> (More risk/discount
                                    = Less value).</li>
                                <li><strong style="color: #0D47A1;">The difference (r - g) is the balance.</strong></li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- SECTION 3: DEEP DIVE -->
                <section class="content-card">
                    <h2 class="section-title">3Ô∏è‚É£ THE EPIC BATTLE: r vs g</h2>

                    <p style="color: #555; font-size: 1.05rem; margin-bottom: 1.5rem; text-align: center;">
                        Le prix de l'action est le r√©sultat direct du combat entre ces deux forces macro-√©conomiques.
                    </p>

                    <div style="display: flex; gap: 2rem; flex-wrap: wrap;">
                        <!-- 'r' Column -->
                        <div
                            style="flex: 1; min-width: 250px; background-color: #FFFDE7; padding: 1.5rem; border-radius: 8px; border-top: 4px solid #FBC02D;">
                            <h3
                                style="color: #F57F17; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; font-size: 1.2rem;">
                                <span>üìâ</span> La Force Qui D√©gonfle (r)
                            </h3>
                            <strong style="color: #111; display: block; margin-bottom: 0.5rem;">Le Cost of
                                Equity</strong>
                            <p style="color: #555; line-height: 1.6; margin-bottom: 0;">
                                C'est la force de gravit√©. C'est le rendement <strong>exig√©</strong> par les
                                investisseurs (Risk-free rate + Risk premium). Plus r est grand (l'investisseur a peur
                                ou l'inflation est forte), plus il divise les dividendes violemment, <strong>faisant
                                    baisser le prix de l'action</strong>.
                            </p>
                        </div>

                        <!-- 'g' Column -->
                        <div
                            style="flex: 1; min-width: 250px; background-color: #E8F5E9; padding: 1.5rem; border-radius: 8px; border-top: 4px solid #4CAF50;">
                            <h3
                                style="color: #2E7D32; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; font-size: 1.2rem;">
                                <span>üìà</span> La Force Qui Booste (g)
                            </h3>
                            <strong style="color: #111; display: block; margin-bottom: 0.5rem;">Le Growth Rate</strong>
                            <p style="color: #555; line-height: 1.6; margin-bottom: 0;">
                                C'est la force de propulsion. C'est la vitesse de croissance interne üí∏ des dividendes.
                                Plus g est grand, plus les profits futurs s'envolent, <strong>faisant monter le prix de
                                    l'action</strong>.
                            </p>
                        </div>
                    </div>
                </section>

                <!-- SECTION 4: EXCEL SAFETY -->
                <section class="content-card" style="border-top: 4px solid #FBC02D;">
                    <h2 class="section-title" style="color: #F57F17;">4Ô∏è‚É£ EXCEL SAFETY: THE 'IF' STRUCTURE</h2>

                    <div
                        style="background-color: #FFFDE7; border: 1px solid #FBC02D; border-radius: 8px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 4px 15px rgba(251, 192, 45, 0.1);">
                        <h3 style="color: #F57F17; margin-bottom: 1rem; font-size: 1.25rem;">General IF structure :</h3>
                        <div class="code-block dark-mode"
                            style="margin-bottom: 2rem; padding: 1.5rem; border-color: #F57F17;">
                            <code><span class="excel-func">=IF</span>( <span class="param">condition</span> ; <span style="color: #C5E1A5;">value_if_true</span> ; <span style="color: #EF9A9A;">value_if_false</span> )</code>
                        </div>

                        <h3 style="color: #F57F17; margin-bottom: 1rem; font-size: 1.25rem;">Applied to Gordon Model :
                        </h3>
                        <div class="code-block dark-mode"
                            style="margin-bottom: 1.5rem; padding: 1.5rem; border-color: #F57F17;">
                            <code><span class="excel-func">=IF</span>( <span class="param">r</span> <= <span class="param">g</span> ; <span style="color: #FFA726;">"Formula doesn't work"</span> ; <span class="param">D1</span> / (<span class="param">r</span> - <span class="param">g</span>) )</code>
                        </div>

                        <div
                            style="background-color: white; border-left: 4px solid #F57F17; padding: 1rem; border-radius: 4px; margin-top: 1.5rem;">
                            <strong style="color: #E65100;">Explication :</strong>
                            <p style="color: #555; margin: 0.5rem 0 0 0; line-height: 1.6;">
                                Si le taux de croissance (g) est plus haut que le taux voulu (r), le mod√®le casse. Le
                                'IF' emp√™che Excel d'afficher une erreur moche ou un prix n√©gatif.
                            </p>
                        </div>
                    </div>
                </section>

                <div class="mt-4 text-center">
                    <button class="btn-note" onclick="toggleNote('note-gordon-trick')"
                        style="margin: 0 auto; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
                        <span class="note-icon">üî•</span> LE PI√àGE MORTEL DE L'EXAMEN
                    </button>
                </div>

                <div id="note-gordon-trick" class="post-it-note"
                    style="background-color: #B2D3C2; max-width: 600px; margin: 2rem auto 2rem auto; box-shadow: 0 10px 25px rgba(0,0,0,0.15); transform: rotate(1deg);">
                    <p
                        style="font-weight: 800; color: #111; font-size: 1.15rem; border-bottom: 2px solid rgba(0,0,0,0.1); padding-bottom: 0.5rem; margin-bottom: 0.8rem; letter-spacing: 0.5px;">
                        TRICK: D0 vs D1
                    </p>
                    <p style="color: #111; line-height: 1.7; font-size: 1.05rem;">
                        If you have D0, calculate D1 first:<br>
                        <strong
                            style="display: block; margin-top: 0.5rem; background: rgba(255,255,255,0.4); padding: 0.5rem; border-radius: 4px;">D‚ÇÅ
                            = D‚ÇÄ &times; (1 + g)</strong>
                    </p>
                </div>

            </div>
        </main>
        <!-- ================= END MAIN CONTENT ================= -->

    </div>

    <!-- Overlay Note System -->
    <div id="note-overlay" class="overlay" onclick="closeNote()"></div>

    <script src="script.js"></script>
</body>

</html>